exports.id=538,exports.ids=[538],exports.modules={3538:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{default:()=>l});var d=t(8732),s=t(4062),o=t(3157);t(9361);var n=t(7912),i=t.n(n),c=e([s,o]);function l({Component:e,pageProps:a}){return(0,d.jsxs)(s.Provider,{store:o.A,children:[(0,d.jsxs)(i(),{children:[(0,d.jsx)("title",{children:"Fashion Store"}),(0,d.jsx)("link",{rel:"icon",href:"https://firebasestorage.googleapis.com/v0/b/red89-f8933.appspot.com/o/KLTN%2FDALL%C2%B7E%202025-01-20%2014.48.34%20-%20A%20minimalistic%20logo%20for%20a%20Fashion%20Store%2C%20designed%20for%20use%20as%20a%20website%20favicon.%20The%20logo%20features%20a%20sleek%20and%20modern%20design%20with%20an%20abstract%20represent.webp?alt=media&token=da1ff9d9-3a6e-44ca-ba4c-6de1a45b80fc"})]}),(0,d.jsx)(e,{...a})]})}[s,o]=c.then?(await c)():c,r()}catch(e){r(e)}})},3157:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{A:()=>p});var d=t(9198),s=t(4358),o=t(7730),n=t(3257),i=t(4660),c=t(5580),l=t(6387),u=t(1931),g=t(6815),y=e([d,s,o,n,i,c,l,u,g]);[d,s,o,n,i,c,l,u,g]=y.then?(await y)():y;let p=(0,d.configureStore)({reducer:{auth:s.Ay,products:o.Ay,cart:n.Ay,reviews:i.Ay,productsByCategory:c.A,colors:l.A,categories:u.Ay,adminUser:g.Ay}});r()}catch(e){r(e)}})},6815:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{Ay:()=>u,_p:()=>i,b7:()=>n});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("admin/login",async(e,{rejectWithValue:a})=>{try{let a=await s.ic.loginForAdmin(e);return{user:a.user,role:a.role}}catch(e){return a(e)}}),i=(0,d.createAsyncThunk)("admin/logout",async(e,{rejectWithValue:a})=>{try{return await s.i$.logout(),!0}catch(e){return a(e.response?.data||e.message)}}),c=(0,d.createSlice)({name:"admin",initialState:{token:null,adminInfo:null,role:null,loading:!1,error:null,accessDenied:!1},reducers:{resetAdminState:e=>{e.adminInfo=null,e.role=null,e.token=null,e.loading=!1,e.error=null,e.accessDenied=!1}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null,e.accessDenied=!1}).addCase(n.fulfilled,(e,a)=>{let{role:t}=a.payload;e.loading=!1,e.adminInfo=a.payload.user,e.role=t,e.token=a.payload.accessToken,e.error=null,e.accessDenied="admin"!==t&&"superadmin"!==t}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error="object"==typeof a.payload&&a.payload.message?a.payload.message:a.payload||"Đăng nhập thất bại!"}).addCase(i.pending,e=>{e.loading=!0}).addCase(i.fulfilled,e=>{e.adminInfo=null,e.role=null,e.token=null,e.loading=!1,e.accessDenied=!1}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload})}}),{resetAdminState:l}=c.actions,u=c.reducer;r()}catch(e){r(e)}})},3257:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{AR:()=>y,Ay:()=>f,Mr:()=>l,SM:()=>u,ci:()=>n,fN:()=>i,je:()=>g,nI:()=>h});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("cart/createCartForGuest",async(e,{rejectWithValue:a})=>{try{return(await s.zb.createCartForGuest(e)).data}catch(e){return a(e.response?.data||"Failed to create cart for guest.")}}),i=(0,d.createAsyncThunk)("cart/createCartForUser",async(e,{rejectWithValue:a})=>{try{return(await s.zb.createCartForUser()).data}catch(e){return a(e.response?.data||"Failed to create or retrieve cart for user.")}}),c=(0,d.createAsyncThunk)("cart/getCartById",async(e,{rejectWithValue:a})=>{try{return(await s.zb.getCartById(e)).data}catch(e){return a(e.response?.data||"Failed to fetch cart details.")}}),l=(0,d.createAsyncThunk)("cart/addItemToCart",async({cartId:e,itemData:a},{rejectWithValue:t})=>{try{return(await s.zb.addItemToCart(e,a)).data}catch(e){return t(e.response?.data||"Failed to add item to cart.")}}),u=(0,d.createAsyncThunk)("cart/removeCartItem",async(e,{rejectWithValue:a})=>{try{return await s.zb.removeCartItem(e)}catch(e){return a(e.response?.data||"Failed to remove item from cart.")}}),g=(0,d.createAsyncThunk)("cart/getCartItems",async(e,{rejectWithValue:a})=>{try{return(await s.zb.getCartItems(e)).data}catch(e){return a(e.response?.data||"Failed to fetch cart items.")}}),y=(0,d.createAsyncThunk)("cart/updateCartItemQuantity",async({itemId:e,quantity:a},{rejectWithValue:t})=>{try{return(await s.zb.updateCartItemQuantity(e,a)).data}catch(e){return t(e.response?.data||"Failed to update cart item quantity.")}}),p=(0,d.createSlice)({name:"cart",initialState:{cart:null,items:[],loading:!1,updating:{},error:null},reducers:{resetCartState:e=>{e.cart=null,e.items=[],e.loading=!1,e.updating={},e.error=null}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.loading=!1,e.cart=a.payload}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.cart=a.payload}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.cart=a.payload}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.items.push(a.payload)}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(u.pending,(e,a)=>{let t=a.meta.arg;e.updating[t]=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{let t=a.meta.arg;e.items=e.items.filter(e=>e.id!==t),delete e.updating[t]}).addCase(u.rejected,(e,a)=>{let t=a.meta.arg;e.updating[t]=!1,e.error=a.payload}).addCase(g.pending,e=>{e.loading=!0,e.error=null}).addCase(g.fulfilled,(e,a)=>{e.loading=!1,e.items=a.payload}).addCase(g.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(y.pending,(e,a)=>{let{itemId:t}=a.meta.arg;e.updating[t]=!0,e.error=null}).addCase(y.fulfilled,(e,a)=>{let t=a.payload,r=e.items.findIndex(e=>e.id===t.id);-1!==r&&(e.items[r]={...e.items[r],...t}),delete e.updating[t.id]}).addCase(y.rejected,(e,a)=>{let{itemId:t}=a.meta.arg;e.updating[t]=!1,e.error=a.payload})}}),{resetCartState:h}=p.actions,f=p.reducer;r()}catch(e){r(e)}})},1931:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{Ay:()=>c,BG:()=>n,jc:()=>i});var d=t(9198),s=e([d]);d=(s.then?(await s)():s)[0];let o=(0,d.createSlice)({name:"categories",initialState:{currentCategoryId:null,selectedCategoryId:null},reducers:{setCurrentCategoryId(e,a){e.currentCategoryId=a.payload},setSelectedCategoryId(e,a){e.selectedCategoryId=a.payload}}}),{setCurrentCategoryId:n,setSelectedCategoryId:i}=o.actions,c=o.reducer;r()}catch(e){r(e)}})},6387:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{A:()=>i,n:()=>n});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("colors/fetchColors",async(e,{rejectWithValue:a})=>{try{return await s.no.getColors()}catch(e){return a(e)}}),i=(0,d.createSlice)({name:"colors",initialState:{data:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.loading=!1,e.data=a.payload}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to fetch colors."})}}).reducer;r()}catch(e){r(e)}})},7730:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{$s:()=>u,Ay:()=>C,_5:()=>c,kf:()=>l});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("products/fetchProducts",async(e,{rejectWithValue:a})=>{try{return await s.GQ.getProducts()}catch(e){return a(e.response?.data||"Failed to fetch products")}}),i=(0,d.createAsyncThunk)("products/fetchProductsByPagination",async({page:e,limit:a},{rejectWithValue:t})=>{try{return await s.GQ.getProductsByPagination(e,a)}catch(e){return t(e.response?.data||"Failed to fetch products with pagination")}}),c=(0,d.createAsyncThunk)("products/fetchNewProductsByPagination",async({page:e,limit:a,sort:t,priceRange:r,colorIds:d},{rejectWithValue:o})=>{try{return await s.GQ.getNewProductsByPagination(e,a,t,r,d)}catch(e){return o(e.response?.data||"Failed to fetch new products")}}),l=(0,d.createAsyncThunk)("products/fetchFeaturedProductsByPagination",async({page:e,limit:a,sort:t,priceRange:r,colorIds:d},{rejectWithValue:o})=>{try{return await s.GQ.getFeaturedProductsByPagination(e,a,t,r,d)}catch(e){return o(e.response?.data||"Failed to fetch featured products")}}),u=(0,d.createAsyncThunk)("products/fetchProductDetail",async(e,{rejectWithValue:a})=>{try{return await s.GQ.getProductDetail(e)}catch(e){return a(e.response?.data||"Failed to fetch product details")}}),g=(0,d.createAsyncThunk)("products/createProduct",async(e,{rejectWithValue:a})=>{try{return await s.GQ.createProduct(e)}catch(e){return a(e.response?.data||"Failed to create product")}}),y=(0,d.createAsyncThunk)("products/updateProduct",async({slug:e,productData:a},{rejectWithValue:t})=>{try{return await s.GQ.updateProduct(e,a)}catch(e){return t(e.response?.data||"Failed to update product")}}),p=(0,d.createAsyncThunk)("products/deleteProduct",async(e,{rejectWithValue:a})=>{try{return await s.GQ.deleteProduct(e)}catch(e){return a(e.response?.data||"Failed to delete product")}}),h=(0,d.createSlice)({name:"products",initialState:{newProducts:{items:[],pagination:{totalItems:0,totalPages:0,currentPage:1,pageSize:10}},visibleNewProducts:[],featuredProducts:{items:[],pagination:{totalItems:0,totalPages:0,currentPage:1,pageSize:10}},visibleFeaturedProducts:[],loading:!1,error:null},reducers:{setVisibleNewProducts:(e,a)=>{e.visibleNewProducts=a.payload},setVisibleFeaturedProducts:(e,a)=>{e.visibleFeaturedProducts=a.payload},clearProductState:e=>{e.newProducts={items:[],pagination:{totalItems:0,totalPages:0,currentPage:1,pageSize:10}},e.visibleNewProducts=[],e.featuredProducts={items:[],pagination:{totalItems:0,totalPages:0,currentPage:1,pageSize:10}},e.visibleFeaturedProducts=[],e.loading=!1,e.error=null}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.items=a.payload,e.loading=!1}).addCase(n.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{let{products:t,pagination:r}=a.payload.data;e.pagination={items:t||[],totalItems:r.totalItems||0,totalPages:r.totalPages||0,currentPage:r.currentPage||1,pageSize:r.pageSize||10},e.loading=!1}).addCase(i.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{let{products:t,pagination:r}=a.payload.data;if(1===r.currentPage)e.newProducts.items=t;else{let a=t.filter(a=>!e.newProducts.items.some(e=>e.id===a.id));e.newProducts.items=[...e.newProducts.items,...a]}e.newProducts.pagination={totalItems:r.totalItems||0,totalPages:r.totalPages||0,currentPage:r.currentPage||1,pageSize:r.pageSize||10},e.visibleNewProducts=e.newProducts.items.slice(0,e.newProducts.pagination.pageSize),e.loading=!1}).addCase(c.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{let{products:t,pagination:r}=a.payload.data;if(1===r.currentPage)e.featuredProducts.items=t;else{let a=t.filter(a=>!e.featuredProducts.items.some(e=>e.id===a.id));e.featuredProducts.items=[...e.featuredProducts.items,...a]}e.featuredProducts.pagination={totalItems:r.totalItems||0,totalPages:r.totalPages||0,currentPage:r.currentPage||1,pageSize:r.pageSize||10},e.visibleFeaturedProducts=e.featuredProducts.items.slice(0,e.featuredProducts.pagination.pageSize),e.loading=!1}).addCase(l.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.currentProduct=a.payload,e.loading=!1}).addCase(u.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(g.pending,e=>{e.loading=!0,e.error=null}).addCase(g.fulfilled,(e,a)=>{e.items.push(a.payload),e.loading=!1}).addCase(g.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(y.pending,e=>{e.loading=!0,e.error=null}).addCase(y.fulfilled,(e,a)=>{let t=e.items.findIndex(e=>e.slug===a.payload.slug);-1!==t&&(e.items[t]=a.payload),e.loading=!1}).addCase(y.rejected,(e,a)=>{e.error=a.payload,e.loading=!1}),e.addCase(p.pending,e=>{e.loading=!0,e.error=null}).addCase(p.fulfilled,(e,a)=>{e.items=e.items.filter(e=>e.slug!==a.meta.arg),e.loading=!1}).addCase(p.rejected,(e,a)=>{e.error=a.payload,e.loading=!1})}}),{setVisibleNewProducts:f,setVisibleFeaturedProducts:w,clearProductState:m}=h.actions,C=h.reducer;r()}catch(e){r(e)}})},5580:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{A:()=>i,c:()=>n});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("productsByCategory/fetchProductsByCategory",async({categoryId:e,page:a,limit:t,sort:r,priceRange:d,colorIds:o},{rejectWithValue:n})=>{try{return await s._i.getProductsByCategory(e,a,t,r,d,o)}catch(e){return n(e)}}),i=(0,d.createSlice)({name:"productsByCategory",initialState:{products:[],totalPages:0,loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.loading=!1;let{products:t,totalPages:r}=a.payload.data;a.meta.arg.page>1?e.products=[...e.products,...t]:e.products=t,e.totalPages=r}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to fetch products by category"})}}).reducer;r()}catch(e){r(e)}})},4660:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{Ay:()=>u,Zx:()=>i,bx:()=>c,ik:()=>n});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("reviews/fetchReviewsByProduct",async({productId:e,page:a,limit:t},r)=>{try{let r=await s.bi.getReviewsByProduct(e,a,t);if("success"===r.status)return{reviews:r.data,meta:r.meta};throw Error("Unexpected API response")}catch(e){return r.rejectWithValue(e.response?.data?.message||"Failed to fetch reviews")}}),i=(0,d.createAsyncThunk)("reviews/fetchAverageRating",async(e,a)=>{try{let a=await s.bi.getAverageRating(e);if("success"===a.status&&a.data?.averageRating)return{averageRating:parseFloat(a.data.averageRating.averageRating)||0,totalReviews:parseInt(a.data.averageRating.totalReviews,10)||0};throw Error("Invalid API response structure")}catch(e){return a.rejectWithValue(e.response?.data?.message||"Failed to fetch average rating")}}),c=(0,d.createAsyncThunk)("reviews/createReview",async(e,a)=>{try{return(await s.bi.createReview(e)).data}catch(e){return a.rejectWithValue(e.response?.data||"Failed to create review")}}),l=(0,d.createAsyncThunk)("reviews/deleteReview",async(e,a)=>{try{return(await s.bi.deleteReview(e)).data}catch(e){return a.rejectWithValue(e.response?.data||"Failed to delete review")}}),u=(0,d.createSlice)({name:"reviews",initialState:{reviews:[],averageRating:0,isLoading:!1,error:null,pagination:{totalReviews:0,totalPages:1,currentPage:1}},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1,e.reviews=a.payload.reviews||[],e.pagination={totalReviews:a.payload.meta?.totalReviews||0,totalPages:a.payload.meta?.totalPages||1,currentPage:a.payload.meta?.currentPage||1}}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}),e.addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1,e.averageRating=a.payload?.averageRating||0,e.pagination.totalReviews=a.payload?.totalReviews||0}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}),e.addCase(c.pending,e=>{e.isLoading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.isLoading=!1,e.reviews.unshift(a.payload),e.pagination.totalReviews+=1,e.reviews.length>10&&e.reviews.pop()}).addCase(c.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}),e.addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.isLoading=!1,e.reviews=e.reviews.filter(e=>e.id!==a.meta.arg),e.pagination.totalReviews=Math.max(0,e.pagination.totalReviews-1)}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}).reducer;r()}catch(e){r(e)}})},4358:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{Ay:()=>p,DY:()=>n,Lx:()=>c,RY:()=>i,ug:()=>u,vw:()=>y,y4:()=>l});var d=t(9198),s=t(1190),o=e([d,s]);[d,s]=o.then?(await o)():o;let n=(0,d.createAsyncThunk)("auth/registerUser",async(e,{rejectWithValue:a})=>{try{return await s.i$.register(e)}catch(e){return a(e.response?.data||e.message)}}),i=(0,d.createAsyncThunk)("auth/verifyOtp",async(e,{rejectWithValue:a})=>{try{return await s.i$.verifyOtp(e)}catch(e){return a(e.response?.data||e.message)}}),c=(0,d.createAsyncThunk)("auth/loginUser",async(e,{rejectWithValue:a})=>{try{return await s.i$.login(e)}catch(e){return a(e.response?.data||e.message)}}),l=(0,d.createAsyncThunk)("auth/logoutUser",async(e,{rejectWithValue:a})=>{try{return await s.i$.logout(),!0}catch(e){return a(e.response?.data||e.message)}}),u=(0,d.createAsyncThunk)("auth/getUserInfo",async(e,{rejectWithValue:a})=>{try{return await s.i$.getUserProfile()}catch(e){return console.error("Error fetching user info:",e),a(e.message||"Failed to fetch user info")}}),g=(0,d.createSlice)({name:"auth",initialState:{user:null,token:null,loading:!1,error:null},reducers:{resetAuthState:e=>{e.user=null,e.token=null,e.loading=!1,e.error=null}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}),e.addCase(n.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user}),e.addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(i.pending,e=>{e.loading=!0,e.error=null}),e.addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user}),e.addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(c.pending,e=>{e.loading=!0,e.error=null}),e.addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload.user,e.token=a.payload.accessToken}),e.addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(l.pending,e=>{e.loading=!0}),e.addCase(l.fulfilled,e=>{e.user=null,e.token=null,e.loading=!1}),e.addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(u.pending,e=>{e.loading=!0,e.error=null}),e.addCase(u.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload}),e.addCase(u.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to fetch user info"})}}),{resetAuthState:y}=g.actions,p=g.reducer;r()}catch(e){r(e)}})},1190:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{GQ:()=>u,NM:()=>f,_i:()=>p,bi:()=>y,i$:()=>c,ic:()=>l,no:()=>h,zb:()=>g});var d=t(1428),s=t(6084),o=t(4358),n=e([d,s,o]);[d,s,o]=n.then?(await n)():n;let i=d.default.create({baseURL:"http://localhost:5551/v1/api/"});i.interceptors.request.use(async e=>{try{let a=(0,s.gf)(),t=(0,s.u0)();a&&(e.headers.Authorization=`Bearer ${a}`),t&&(e.headers["x-session-id"]=t)}catch(e){console.error("Error adding headers:",e)}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>{console.log("Response received:",e);let a=e.headers?.["x-session-id"];return a&&((0,s.mY)(a),console.log("Session ID saved from response:",a)),e},async e=>{let a=e.config;if(console.log("Error response:",e.response||"No response available"),a._retryCount||(a._retryCount=0),e.response?.status===403&&e.response?.data?.message==="Refresh Token kh\xf4ng tồn tại")return console.log("Refresh token does not exist. Logging out..."),(0,s.Md)(),store.dispatch((0,o.vw)()),new Promise(()=>{});if(a.url.includes("/users/refresh-token"))return console.log("Refresh token request failed. Stopping retries."),(0,s.i1)(),store.dispatch((0,o.vw)()),new Promise(()=>{});if(e.response?.status===403&&a._retryCount<5){a._retryCount+=1,console.log(`Retrying request (${a._retryCount}/5)...`);try{let e=await c.refreshToken();return a.headers.Authorization=`Bearer ${e}`,i(a)}catch(e){return console.log("Error during token refresh:",e),new Promise(()=>{})}}return a._retryCount>=5?(console.log("Maximum retry attempts reached."),new Promise(()=>{})):Promise.reject(e)});let c={register:async e=>{try{return(await i.post("users/register",e)).data}catch(e){throw e}},verifyOtp:async e=>{try{return(await i.post("users/verify-otp",e)).data}catch(e){throw e}},login:async e=>{try{let a=await i.post("users/login",e),{accessToken:t,refreshToken:r}=a.data.data;t&&r&&((0,s.L4)(""),(0,s.WG)(t),(0,s.fE)(r),(0,s.yb)());let d=a.headers["x-session-id"];return d&&((0,s.mY)(d),console.log("Session ID received and saved during login:",d)),a.data}catch(e){throw e}},logout:async()=>{try{let e=(0,s.ve)(),a=(0,s.F6)();return await i.post("users/logout",{refreshToken:e,userId:a}),(0,s.i1)(),(0,s.FA)(),(0,s.Fb)(),(0,s.i1)(),(0,s.eF)(),(0,s.yb)(),(0,s.Tj)(),{message:"Logout successful"}}catch(e){throw e.response?.data||"Logout failed"}},getUserProfile:async()=>{try{return(await i.get("users/profile")).data.data}catch(e){throw e.response?.data||"Failed to fetch user profile"}},refreshToken:async()=>{try{let e=(0,s.ve)();(0,s.F6)();let{accessToken:a,refreshToken:t}=(await i.post("users/refresh-token",{get_refreshToken:e})).data.data;return a&&t&&((0,s.WG)(a),(0,s.fE)(t)),a}catch(e){throw Error("Token refresh failed. Please log in again.")}}},l={loginForAdmin:async e=>{try{let a=await i.post("users/login-admin",e),{accessToken:t,refreshToken:r,role:d}=a.data.data;t&&r&&((0,s.WG)(t),(0,s.fE)(r),(0,s.L4)(d));let o=a.headers["x-session-id"];return o&&(0,s.mY)(o),{user:a.data.user,role:d}}catch(e){throw e.response?.data||e.message}}},u={createProduct:async e=>(await i.post("products/",e)).data,getProducts:async()=>(await i.get("products/")).data.data,getProductDetail:async e=>(await i.get(`products/${e}`)).data.data,updateProduct:async(e,a)=>(await i.put(`products/${e}`,a)).data,deleteProduct:async e=>(await i.delete(`products/${e}`)).data,getProductsByPagination:async(e,a)=>(await i.get(`products/pagination?page=${e}&limit=${a}`)).data,getNewProductsByPagination:async(e,a,t,r,d)=>{try{let s=new URLSearchParams({page:e,limit:a,sort:t,priceRange:r||"",colorIds:d||""}).toString();return(await i.get(`products/new?${s}`)).data}catch(e){throw console.error("Error fetching new products:",e),e.response?.data||"Failed to fetch new products."}},getFeaturedProductsByPagination:async(e,a,t,r,d)=>{try{let s=new URLSearchParams({page:e,limit:a,sort:t,priceRange:r||"",colorIds:d||""}).toString();return(await i.get(`products/featured?${s}`)).data}catch(e){throw console.error("Error fetching featured products:",e),e.response?.data||"Failed to fetch featured products."}}},g={createCartForGuest:async e=>{try{let a=await i.post("carts/guest",e),{id:t}=a.data.data;return t&&(console.log("Cart ID:",t),(0,s.Om)(t)),a.data}catch(e){throw e.response?.data||"Failed to create cart for guest."}},createCartForUser:async()=>{try{let e=await i.post("carts/user"),{id:a}=e.data.data;return a&&(console.log("Cart ID:",a),(0,s.Om)(a)),e.data}catch(e){throw e.response?.data||"Failed to create or retrieve cart for user."}},getCartById:async e=>{try{return(await i.get(`carts/${e}`)).data}catch(e){throw e.response?.data||"Failed to fetch cart details."}},addItemToCart:async(e,a)=>{try{return(await i.post(`carts/${e}/items`,a)).data}catch(e){throw e.response?.data||"Failed to add item to cart."}},removeCartItem:async e=>{try{return(await i.delete(`carts/items/${e}`)).data}catch(e){throw e.response?.data||"Failed to remove item from cart."}},getCartItems:async e=>{try{return(await i.get(`carts/${e}/items`)).data}catch(e){throw e.response?.data||"Failed to fetch cart items."}},updateCartItemQuantity:async(e,a)=>{try{return(await i.put(`carts/item/${e}`,{quantity:a})).data}catch(e){throw e.response?.data||"Failed to update cart item quantity."}}},y={createReview:async e=>{try{return(await i.post("reviews/",e)).data}catch(e){throw e.response?.data||"Failed to create review."}},getReviewsByProduct:async(e,a,t)=>{try{return(await i.get(`reviews/product/${e}?page=${a}&limit=${t}`)).data}catch(e){throw e.response?.data||"Failed to fetch reviews."}},getAverageRating:async e=>{try{return(await i.get(`reviews/product/${e}/average-rating`)).data}catch(e){throw e.response?.data||"Failed to fetch average rating."}},deleteReview:async e=>{try{return(await i.delete(`reviews/${e}`)).data}catch(e){throw e.response?.data||"Failed to delete review."}}},p={getProductsByCategory:async(e,a,t,r,d,s)=>{try{let o=new URLSearchParams({page:a,limit:t,sort:r,priceRange:d||"",colorIds:s||""}).toString();return(await i.get(`products-by-category/${e}?${o}`)).data}catch(e){throw e.response?.data||"Failed to fetch products by category."}}},h={getColors:async()=>{try{return(await i.get("colors")).data.data}catch(e){throw e.response?.data||"Failed to fetch colors."}}},f={getNewProducts:async(e,a)=>(await i.get("/products/news",{params:{page:e,limit:a}})).data,getFeaturedProducts:async(e,a)=>(await i.get("/products/featureds",{params:{page:e,limit:a}})).data};r()}catch(e){r(e)}})},6084:(e,a,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(a,{Cy:()=>k,F6:()=>m,FA:()=>w,Fb:()=>C,L4:()=>I,Lw:()=>R,Md:()=>j,Om:()=>A,Tj:()=>b,WG:()=>g,eF:()=>p,fE:()=>h,gf:()=>y,i1:()=>F,mY:()=>v,u0:()=>P,ve:()=>f,yb:()=>S});var d=t(6338),s=e([d]);d=(s.then?(await s)():s)[0];let o="token",n="refreshToken",i="userId",c="sessionId",l="cartId",u="role",g=e=>d.default.set(o,e,{expires:7,secure:!0,sameSite:"Strict"}),y=()=>d.default.get(o),p=()=>d.default.remove(o),h=e=>d.default.set(n,e,{expires:7,secure:!0,sameSite:"Strict"}),f=()=>d.default.get(n),w=()=>d.default.remove(n),m=()=>d.default.get(i),C=()=>d.default.remove(i),v=e=>d.default.set(c,e,{expires:7,secure:!1,sameSite:"Strict"}),P=()=>d.default.get(c),F=()=>d.default.remove(c),A=e=>d.default.set(l,e,{expires:7,secure:!1,sameSite:"Strict"}),k=()=>d.default.get(l),S=()=>d.default.remove(l),I=e=>d.default.set(u,e,{expires:7,secure:!1,sameSite:"Strict"}),R=()=>d.default.get(u),b=()=>d.default.remove(u),j=()=>{d.default.remove(o),d.default.remove(n),d.default.remove(i),d.default.remove(c),d.default.remove(l),d.default.remove(u)};r()}catch(e){r(e)}})},9361:()=>{}};